<%- include('../partials/header') %>
<style>
    body {
        background-color: black;
    }
</style>
<div id="profile-bio-section">
        <div id="profile-picture" style="background-image: url(<%=user.avatar%>);"> </div>
        <div style="color: white;">
            <h3>User Name : </h3>
        </div>
        <div id="user-username">
            <h3><%= user.name%></h3>
        </div>
    
    </div>

<%if (user.posts.length){%>
<% user.posts.forEach ( post => {%>
<div id="post-holder" style="margin-top: 1%; width: 80%; margin-left: 10%;">
    <div id="post-pic"><img id="image" src="<%= post.image%>" alt=""></div>
    <div id="caption-holder">
            <div id="car-information"><h2 style="font-size: 35px;font-family: 'Arvo', serif;"> <span><%= post.brand%> </span><span> <%= post.model%> </span><span> <%= post.year%><h2></span>
        <h2 style="font-family: 'Arvo', serif;font-size: 30px;"><%= post.horsePower %> hp  <span> <%= post.engine %></h2></div>
        <h2 style="font-family: 'Arvo', serif;"><%= post.caption%></h2>    
    </div>
</div>
<div id="comments-holder">
        <% if (post.comments.length){%>
        <%post.comments.forEach ((comment, index) => {%>
        <% if (comment.visitorId == loggedInUser._id){%>
        <div class="logged-in-user-comment" style="border-bottom: 2px solid rgb(0, 0, 0);">
            <div class="commenter-information">
                <div class="icon-holder" style="background-image: url('<%= loggedInUser.avatar %>');"></div></a>
                <a style="color: white; text-decoration: none;" href="/users/profile/<%= loggedInUser._id%>"> <%= loggedInUser.name%></a>
                <span style="color: red; font-size: 20px;"> : </span>
            </div>
            <p style="margin-left: .5%; width: 85%;"> <%= comment.comment%></p>
            <form class="comment-delete-form"
                action="/posts/comment/<%= user._id%>?_method=DELETE&postId=<%= post._id%>&commentIdx=<%= index %>"
                method="POST">
                <input id="remove" type="submit" value="✘">
            </form>

        </div>
        <%} 

                else {%>

        <div class="logged-in-user-comment" style="border-bottom: 2px solid rgb(0, 0, 0);">
            <div class="commenter-information">
                <div class="icon-holder" style="background-image: url('<%= comment.visitorAvatar %>');"></div></a>
                <a style="color: white; text-decoration: none;" href="/users/<%= comment.visitorId%>"> <%= comment.visitorName%> </a>
                <span style="color: red; font-size: 20px;"> : </span>
            </div>
            <p style="margin-left: .5%; width: 88%;"> <%= comment.comment%></p>
            <!-- <p> <%= comment.comment%></p> -->
        </div>

        <% }%>

        <%})%>
        <%};%>
    </div>

<div id="new-comment-holder" style="width: 80%; margin-left:10% ; margin-top: 1%;">
    <form id="new-comment-form" action="/posts/comment/<%= user._id%>?postId=<%= post._id %>" method="POST">
        <input required id="comment-input" type="text" placeholder="comment ..." name="comment">
        <button type="submit"> ✉ </button>
    </form>
</div>
<% }) ;%>
<%} else {%>
<h1 style="margin: 20% 50%; color: teal;">NO POSTS YET</h1>
<%}%>   
   
<%- include('../partials/footer') %>